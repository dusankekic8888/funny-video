"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/me";
exports.ids = ["pages/api/me"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "./middleware/mongodb.ts":
/*!*******************************!*\
  !*** ./middleware/mongodb.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst connectDB = (handler)=>async (req, res)=>{\n        if ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().connections[0].readyState)) {\n            // Use current db connection\n            return handler(req, res);\n        }\n        const mongoUrl = process.env.MONGO_URL || '';\n        // Use new db connection\n        await mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(mongoUrl, {\n            useUnifiedTopology: true,\n            useFindAndModify: false,\n            useCreateIndex: true,\n            useNewUrlParser: true\n        });\n        return handler(req, res);\n    }\n;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (connectDB);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9taWRkbGV3YXJlL21vbmdvZGIudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQStCO0FBRy9CLEtBQUssQ0FBQ0MsU0FBUyxJQUNaQyxPQUE0RCxVQUN0REMsR0FBbUIsRUFBRUMsR0FBb0IsR0FBSyxDQUFDO1FBQ3BELEVBQUUsRUFBRUosMkVBQWtDLEVBQUUsQ0FBQztZQUN2QyxFQUE0QjtZQUM1QixNQUFNLENBQUNFLE9BQU8sQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHO1FBQ3pCLENBQUM7UUFFRCxLQUFLLENBQUNHLFFBQVEsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFNBQVMsSUFBSSxDQUFFO1FBQzVDLEVBQXdCO1FBQ3hCLEtBQUssQ0FBQ1YsdURBQWdCLENBQUNPLFFBQVEsRUFBRSxDQUFDO1lBQ2hDSyxrQkFBa0IsRUFBRSxJQUFJO1lBQ3hCQyxnQkFBZ0IsRUFBRSxLQUFLO1lBQ3ZCQyxjQUFjLEVBQUUsSUFBSTtZQUNwQkMsZUFBZSxFQUFFLElBQUk7UUFDdkIsQ0FBQztRQUVELE1BQU0sQ0FBQ2IsT0FBTyxDQUFDQyxHQUFHLEVBQUVDLEdBQUc7SUFDekIsQ0FBQzs7QUFFSCxpRUFBZUgsU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZnVubnktbW92aWVzLy4vbWlkZGxld2FyZS9tb25nb2RiLnRzPzhmNmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuXG5jb25zdCBjb25uZWN0REIgPVxuICAoaGFuZGxlcjogKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB2b2lkKSA9PlxuICBhc3luYyAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcbiAgICBpZiAobW9uZ29vc2UuY29ubmVjdGlvbnNbMF0ucmVhZHlTdGF0ZSkge1xuICAgICAgLy8gVXNlIGN1cnJlbnQgZGIgY29ubmVjdGlvblxuICAgICAgcmV0dXJuIGhhbmRsZXIocmVxLCByZXMpO1xuICAgIH1cblxuICAgIGNvbnN0IG1vbmdvVXJsID0gcHJvY2Vzcy5lbnYuTU9OR09fVVJMIHx8ICcnO1xuICAgIC8vIFVzZSBuZXcgZGIgY29ubmVjdGlvblxuICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QobW9uZ29VcmwsIHtcbiAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICAgIHVzZUZpbmRBbmRNb2RpZnk6IGZhbHNlLFxuICAgICAgdXNlQ3JlYXRlSW5kZXg6IHRydWUsXG4gICAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gaGFuZGxlcihyZXEsIHJlcyk7XG4gIH07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3REQjtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsImNvbm5lY3REQiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJjb25uZWN0aW9ucyIsInJlYWR5U3RhdGUiLCJtb25nb1VybCIsInByb2Nlc3MiLCJlbnYiLCJNT05HT19VUkwiLCJjb25uZWN0IiwidXNlVW5pZmllZFRvcG9sb2d5IiwidXNlRmluZEFuZE1vZGlmeSIsInVzZUNyZWF0ZUluZGV4IiwidXNlTmV3VXJsUGFyc2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./middleware/mongodb.ts\n");

/***/ }),

/***/ "./middleware/withProtect.ts":
/*!***********************************!*\
  !*** ./middleware/withProtect.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _models_user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/user */ \"./models/user.ts\");\n\n\nconst withProtect = (handler)=>{\n    return async (req, res)=>{\n        const jwtSecret = process.env.JWT_SECRET || 'funnyMovies';\n        // Get token and check if it exists\n        let token;\n        if (req.cookies && req.cookies.token) {\n            token = req.cookies.token;\n        }\n        if (!token) {\n            return res.status(401).json({\n                success: false,\n                message: 'Please log in to get access.'\n            });\n        }\n        try {\n            // Verify token\n            const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, jwtSecret);\n            // Check if user exists with refresh token\n            const currentUser = await _models_user__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({\n                email: decoded.email\n            });\n            if (!currentUser) {\n                return res.status(401).json({\n                    success: false,\n                    message: 'The user belonging to this token no longer exist.'\n                });\n            }\n            req.user = currentUser;\n            return handler(req, res);\n        } catch (error) {\n            return res.status(401).json({\n                success: false,\n                message: 'Please log in to get access.'\n            });\n        }\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (withProtect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9taWRkbGV3YXJlL3dpdGhQcm90ZWN0LnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDOEI7QUFHRztBQUVqQyxLQUFLLENBQUNFLFdBQVcsSUFBSUMsT0FBWSxHQUFLLENBQUM7SUFDckMsTUFBTSxRQUFRQyxHQUFRLEVBQUVDLEdBQW9CLEdBQUssQ0FBQztRQUNoRCxLQUFLLENBQUNDLFNBQVMsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFVBQVUsSUFBSSxDQUFhO1FBRXpELEVBQW1DO1FBQ25DLEdBQUcsQ0FBQ0MsS0FBSztRQUVULEVBQUUsRUFBRU4sR0FBRyxDQUFDTyxPQUFPLElBQUlQLEdBQUcsQ0FBQ08sT0FBTyxDQUFDRCxLQUFLLEVBQUUsQ0FBQztZQUNyQ0EsS0FBSyxHQUFHTixHQUFHLENBQUNPLE9BQU8sQ0FBQ0QsS0FBSztRQUMzQixDQUFDO1FBRUQsRUFBRSxHQUFHQSxLQUFLLEVBQUUsQ0FBQztZQUNYLE1BQU0sQ0FBQ0wsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztnQkFDM0JDLE9BQU8sRUFBRSxLQUFLO2dCQUNkQyxPQUFPLEVBQUUsQ0FBOEI7WUFDekMsQ0FBQztRQUNILENBQUM7UUFFRCxHQUFHLENBQUMsQ0FBQztZQUNILEVBQWU7WUFDZixLQUFLLENBQUNDLE9BQU8sR0FBR2hCLDBEQUFVLENBQUNVLEtBQUssRUFBRUosU0FBUztZQUMzQyxFQUEwQztZQUMxQyxLQUFLLENBQUNZLFdBQVcsR0FBRyxLQUFLLENBQUNqQiw0REFBWSxDQUFDLENBQUM7Z0JBQUNtQixLQUFLLEVBQUVKLE9BQU8sQ0FBQ0ksS0FBSztZQUFDLENBQUM7WUFDL0QsRUFBRSxHQUFHRixXQUFXLEVBQUUsQ0FBQztnQkFDakIsTUFBTSxDQUFDYixHQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO29CQUMzQkMsT0FBTyxFQUFFLEtBQUs7b0JBQ2RDLE9BQU8sRUFBRSxDQUFtRDtnQkFDOUQsQ0FBQztZQUNILENBQUM7WUFFRFgsR0FBRyxDQUFDaUIsSUFBSSxHQUFHSCxXQUFXO1lBRXRCLE1BQU0sQ0FBQ2YsT0FBTyxDQUFDQyxHQUFHLEVBQUVDLEdBQUc7UUFDekIsQ0FBQyxDQUFDLEtBQUssRUFBRWlCLEtBQUssRUFBRSxDQUFDO1lBQ2YsTUFBTSxDQUFDakIsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztnQkFDM0JDLE9BQU8sRUFBRSxLQUFLO2dCQUNkQyxPQUFPLEVBQUUsQ0FBOEI7WUFDekMsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVELGlFQUFlYixXQUFXLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mdW5ueS1tb3ZpZXMvLi9taWRkbGV3YXJlL3dpdGhQcm90ZWN0LnRzPzBkMDIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgeyBVc2VyVHlwZSB9IGZyb20gJ0AvdHlwZS91c2VyJztcbmltcG9ydCBVc2VyIGZyb20gJy4uL21vZGVscy91c2VyJztcblxuY29uc3Qgd2l0aFByb3RlY3QgPSAoaGFuZGxlcjogYW55KSA9PiB7XG4gIHJldHVybiBhc3luYyAocmVxOiBhbnksIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XG4gICAgY29uc3Qgand0U2VjcmV0ID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAnZnVubnlNb3ZpZXMnO1xuXG4gICAgLy8gR2V0IHRva2VuIGFuZCBjaGVjayBpZiBpdCBleGlzdHNcbiAgICBsZXQgdG9rZW47XG5cbiAgICBpZiAocmVxLmNvb2tpZXMgJiYgcmVxLmNvb2tpZXMudG9rZW4pIHtcbiAgICAgIHRva2VuID0gcmVxLmNvb2tpZXMudG9rZW47XG4gICAgfVxuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdQbGVhc2UgbG9nIGluIHRvIGdldCBhY2Nlc3MuJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBWZXJpZnkgdG9rZW5cbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBqd3RTZWNyZXQpIGFzIFVzZXJUeXBlO1xuICAgICAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHMgd2l0aCByZWZyZXNoIHRva2VuXG4gICAgICBjb25zdCBjdXJyZW50VXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IGVtYWlsOiBkZWNvZGVkLmVtYWlsIH0pO1xuICAgICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgdXNlciBiZWxvbmdpbmcgdG8gdGhpcyB0b2tlbiBubyBsb25nZXIgZXhpc3QuJyxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJlcS51c2VyID0gY3VycmVudFVzZXI7XG5cbiAgICAgIHJldHVybiBoYW5kbGVyKHJlcSwgcmVzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdQbGVhc2UgbG9nIGluIHRvIGdldCBhY2Nlc3MuJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhQcm90ZWN0O1xuIl0sIm5hbWVzIjpbImp3dCIsIlVzZXIiLCJ3aXRoUHJvdGVjdCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJqd3RTZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInRva2VuIiwiY29va2llcyIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsImRlY29kZWQiLCJ2ZXJpZnkiLCJjdXJyZW50VXNlciIsImZpbmRPbmUiLCJlbWFpbCIsInVzZXIiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./middleware/withProtect.ts\n");

/***/ }),

/***/ "./models/user.ts":
/*!************************!*\
  !*** ./models/user.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst Schema = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema);\nconst User = new Schema({\n    userId: {\n        type: String,\n        required: true\n    },\n    email: {\n        type: String,\n        required: true\n    },\n    password: {\n        type: String,\n        required: true\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models.User) || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model('User', User));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9tb2RlbHMvdXNlci50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBK0I7QUFDL0IsS0FBSyxDQUFDQyxNQUFNLEdBQUdELHdEQUFlO0FBRTlCLEtBQUssQ0FBQ0UsSUFBSSxHQUFHLEdBQUcsQ0FBQ0QsTUFBTSxDQUFDLENBQUM7SUFDdkJFLE1BQU0sRUFBRSxDQUFDO1FBQ1BDLElBQUksRUFBRUMsTUFBTTtRQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNoQixDQUFDO0lBQ0RDLEtBQUssRUFBRSxDQUFDO1FBQ05ILElBQUksRUFBRUMsTUFBTTtRQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNoQixDQUFDO0lBQ0RFLFFBQVEsRUFBRSxDQUFDO1FBQ1RKLElBQUksRUFBRUMsTUFBTTtRQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNoQixDQUFDO0FBQ0gsQ0FBQztBQUVELGlFQUFlTiw2REFBb0IsSUFBSUEscURBQWMsQ0FBQyxDQUFNLE9BQUVFLElBQUksQ0FBQyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZnVubnktbW92aWVzLy4vbW9kZWxzL3VzZXIudHM/NzAwYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuXG5jb25zdCBVc2VyID0gbmV3IFNjaGVtYSh7XG4gIHVzZXJJZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZW1haWw6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHBhc3N3b3JkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IG1vbmdvb3NlLm1vZGVscy5Vc2VyIHx8IG1vbmdvb3NlLm1vZGVsKCdVc2VyJywgVXNlcik7XG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJTY2hlbWEiLCJVc2VyIiwidXNlcklkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwiZW1haWwiLCJwYXNzd29yZCIsIm1vZGVscyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./models/user.ts\n");

/***/ }),

/***/ "./pages/api/me.ts":
/*!*************************!*\
  !*** ./pages/api/me.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var middleware_mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! middleware/mongodb */ \"./middleware/mongodb.ts\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var middleware_withProtect__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! middleware/withProtect */ \"./middleware/withProtect.ts\");\n\n\n\nasync function handler(req, res) {\n    const jwtSecret = process.env.JWT_SECRET || 'funnyMovies';\n    if (req.method === 'GET') {\n        if (!('token' in req.cookies)) {\n            res.status(401).json({\n                message: 'Unable to auth'\n            });\n            return;\n        }\n        let decoded;\n        const token = req.cookies.token;\n        if (token) {\n            try {\n                decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, jwtSecret);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n        if (decoded) {\n            res.json(decoded);\n            return;\n        } else {\n            res.status(401).json({\n                message: 'Unable to auth'\n            });\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,middleware_mongodb__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,middleware_withProtect__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(handler)));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9hcGkvbWUudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMEM7QUFJWjtBQUNrQjtlQUVqQ0csT0FBTyxDQUFDQyxHQUFtQixFQUFFQyxHQUFvQixFQUFFLENBQUM7SUFDakUsS0FBSyxDQUFDQyxTQUFTLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLElBQUksQ0FBYTtJQUV6RCxFQUFFLEVBQUVMLEdBQUcsQ0FBQ00sTUFBTSxLQUFLLENBQUssTUFBRSxDQUFDO1FBQ3pCLEVBQUUsSUFBSSxDQUFPLFVBQUlOLEdBQUcsQ0FBQ08sT0FBTyxHQUFHLENBQUM7WUFDOUJOLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsRUFBRUMsSUFBSSxDQUFDLENBQUM7Z0JBQUNDLE9BQU8sRUFBRSxDQUFnQjtZQUFDLENBQUM7WUFDbEQsTUFBTTtRQUNSLENBQUM7UUFDRCxHQUFHLENBQUNDLE9BQU87UUFDWCxLQUFLLENBQUNDLEtBQUssR0FBR1osR0FBRyxDQUFDTyxPQUFPLENBQUNLLEtBQUs7UUFDL0IsRUFBRSxFQUFFQSxLQUFLLEVBQUUsQ0FBQztZQUNWLEdBQUcsQ0FBQyxDQUFDO2dCQUNIRCxPQUFPLEdBQUdkLDBEQUFVLENBQUNlLEtBQUssRUFBRVYsU0FBUztZQUN2QyxDQUFDLENBQUMsS0FBSyxFQUFFWSxDQUFDLEVBQUUsQ0FBQztnQkFDWEMsT0FBTyxDQUFDQyxLQUFLLENBQUNGLENBQUM7WUFDakIsQ0FBQztRQUNILENBQUM7UUFFRCxFQUFFLEVBQUVILE9BQU8sRUFBRSxDQUFDO1lBQ1pWLEdBQUcsQ0FBQ1EsSUFBSSxDQUFDRSxPQUFPO1lBQ2hCLE1BQU07UUFDUixDQUFDLE1BQU0sQ0FBQztZQUNOVixHQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO2dCQUFDQyxPQUFPLEVBQUUsQ0FBZ0I7WUFBQyxDQUFDO1FBQ3BELENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVELGlFQUFlZCw4REFBUyxDQUFDRSxrRUFBVyxDQUFDQyxPQUFPLEVBQUUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2Z1bm55LW1vdmllcy8uL3BhZ2VzL2FwaS9tZS50cz83YzI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjb25uZWN0REIgZnJvbSAnbWlkZGxld2FyZS9tb25nb2RiJztcbmltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBVc2VyIGZyb20gJ21vZGVscy91c2VyJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0JztcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCB3aXRoUHJvdGVjdCBmcm9tICdtaWRkbGV3YXJlL3dpdGhQcm90ZWN0JztcblxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCBqd3RTZWNyZXQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICdmdW5ueU1vdmllcyc7XG5cbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgaWYgKCEoJ3Rva2VuJyBpbiByZXEuY29va2llcykpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogJ1VuYWJsZSB0byBhdXRoJyB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGRlY29kZWQ7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy50b2tlbjtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBqd3RTZWNyZXQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkZWNvZGVkKSB7XG4gICAgICByZXMuanNvbihkZWNvZGVkKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBtZXNzYWdlOiAnVW5hYmxlIHRvIGF1dGgnIH0pO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0REIod2l0aFByb3RlY3QoaGFuZGxlcikpO1xuIl0sIm5hbWVzIjpbImNvbm5lY3REQiIsImp3dCIsIndpdGhQcm90ZWN0IiwiaGFuZGxlciIsInJlcSIsInJlcyIsImp3dFNlY3JldCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwibWV0aG9kIiwiY29va2llcyIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZGVjb2RlZCIsInRva2VuIiwidmVyaWZ5IiwiZSIsImNvbnNvbGUiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/api/me.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/api/me.ts"));
module.exports = __webpack_exports__;

})();